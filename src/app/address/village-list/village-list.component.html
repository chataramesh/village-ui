<div class="village-list-container">
  
  <!-- Header -->
  <div class="page-header">
    <div class="header-content">
      <h1 class="page-title">
        <span class="title-icon">üèòÔ∏è</span>
        Village Management
      </h1>
      <p class="page-subtitle">Manage and monitor all villages in the system</p>
    </div>
  </div>

  <!-- Stats Cards -->
  <div class="stats-grid">
    <div class="stat-card total-card">
      <div class="stat-icon-wrapper">
        <svg class="stat-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
        </svg>
      </div>
      <div class="stat-content">
        <h3 class="stat-value">{{totalVillages}}</h3>
        <p class="stat-label">Total Villages</p>
      </div>
    </div>

    <div class="stat-card active-card">
      <div class="stat-icon-wrapper">
        <svg class="stat-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
      </div>
      <div class="stat-content">
        <h3 class="stat-value">{{activeVillages}}</h3>
        <p class="stat-label">Active Villages</p>
      </div>
    </div>

    <div class="stat-card inactive-card">
      <div class="stat-icon-wrapper">
        <svg class="stat-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
      </div>
      <div class="stat-content">
        <h3 class="stat-value">{{inactiveVillages}}</h3>
        <p class="stat-label">Inactive Villages</p>
      </div>
    </div>
  </div>

  <!-- Table Section -->
  <div class="table-section">
    
    <!-- Table Header with Controls -->
    <div class="table-header">
      <div class="table-title-section">
        <h2 class="table-title">All Villages</h2>
        <span class="table-count">{{filteredVillages.length}} villages</span>
      </div>
      <button class="create-btn" (click)="openCreateModal()">
        <svg class="btn-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
        </svg>
        Create Village
      </button>
    </div>

    <!-- Filters and Search -->
    <div class="table-controls">
      <div class="search-wrapper">
        <svg class="search-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
        </svg>
        <input 
          type="text" 
          class="search-input" 
          placeholder="Search by village name, mandal, or district..."
          [(ngModel)]="searchTerm"
          (input)="onSearch()">
        <button class="clear-search" *ngIf="searchTerm" (click)="clearSearch()">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>

      <div class="filter-group">
        <select class="filter-select" [(ngModel)]="stateFilter" (change)="onFilterChange()">
          <option value="all">All States</option>
          <option *ngFor="let state of states" [value]="state">{{state}}</option>
        </select>

        <select class="filter-select" [(ngModel)]="districtFilter" (change)="onFilterChange()">
          <option value="all">All Districts</option>
          <option *ngFor="let district of districts" [value]="district">{{district}}</option>
        </select>
      </div>
    </div>

    <!-- Table -->
    <div class="table-wrapper">
      <table class="villages-table">
        <thead>
          <tr>
            <th>Village Name</th>
            <th>Mandal</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <ng-container *ngFor="let village of filteredVillages; let i = index">
            <!-- Main Row -->
            <tr class="village-row">
              <td>
                <div class="village-info">
                  <div class="village-avatar">{{village.name.charAt(0).toUpperCase()}}</div>
                  <span class="village-name">{{village.name}}</span>
                </div>
              </td>
              <td>{{getMandalName(village)}}</td>
              <td>
                <span class="status-badge" [class.active]="village.active" [class.inactive]="!village.active">
                  <span class="status-dot"></span>
                  {{village.active ? 'Active' : 'Inactive'}}
                </span>
              </td>
              <td>
                <div class="action-buttons">
                  <button class="action-btn edit-btn" (click)="editVillage(village)" title="Edit">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                            d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                    </svg>
                  </button>
                  <button class="action-btn delete-btn" (click)="deleteVillage(village.id!)" title="Delete">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                            d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                    </svg>
                  </button>
                </div>
              </td>
            </tr>
          </ng-container>

          <!-- Empty State -->
          <tr *ngIf="filteredVillages.length === 0" class="empty-row">
            <td colspan="4">
              <div class="empty-state">
                <svg class="empty-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                        d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"></path>
                </svg>
                <p class="empty-text">No villages found</p>
                <p class="empty-subtext">Try adjusting your search or filters</p>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Pagination Placeholder -->
    <div class="pagination-section">
      <div class="pagination-info">
        Showing {{filteredVillages.length}} of {{totalVillages}} villages
      </div>
      <div class="pagination-controls">
        <button class="pagination-btn" disabled>
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
          </svg>
          Previous
        </button>
        <div class="page-numbers">
          <button class="page-number active">1</button>
          <button class="page-number">2</button>
          <button class="page-number">3</button>
        </div>
        <button class="pagination-btn">
          Next
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
          </svg>
        </button>
      </div>
    </div>

  </div>

</div>

<!-- Create/Edit Village Modal -->
<div class="modal-overlay" *ngIf="showModal" (click)="closeModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2 class="modal-title">{{isEditMode ? 'Edit Village' : 'Create New Village'}}</h2>
      <button class="modal-close" (click)="closeModal()">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>
    </div>
    
    <form class="modal-form" (ngSubmit)="saveVillage()">
      <div class="form-group">
        <label class="form-label">Village Name *</label>
        <input 
          type="text" 
          class="form-input" 
          [(ngModel)]="formData.name" 
          name="name"
          placeholder="Enter village name"
          required>
      </div>

      <div class="form-group">
        <label class="form-label">Mandal *</label>
        <select class="form-input" [(ngModel)]="formData.mandalId" name="mandalId" required>
          <option value="">Select Mandal</option>
          <option *ngFor="let mandal of mandals" [value]="mandal.id">{{mandal.name}}</option>
        </select>
      </div>

      <div class="form-group">
        <label class="checkbox-label">
          <input type="checkbox" [(ngModel)]="formData.active" name="active">
          <span>Active</span>
        </label>
      </div>

      <div class="modal-actions">
        <button type="button" class="btn btn-secondary" (click)="closeModal()">Cancel</button>
        <button type="submit" class="btn btn-primary">{{isEditMode ? 'Update' : 'Create'}}</button>
      </div>
    </form>
  </div>
</div>
